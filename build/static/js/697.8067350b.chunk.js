"use strict";(self.webpackChunkmediconnect_frontend=self.webpackChunkmediconnect_frontend||[]).push([[697],{697:(e,a,s)=>{s.r(a),s.d(a,{default:()=>m});var r=s(986),n=s(379),t=s(43),o=s(216),l=s(528),d=s(996),i=s(579);const c=["email"],m=()=>{const{currentUser:e,updateCurrentUser:a}=(0,l.A)(),s=(0,o.Zp)(),[m,h]=(0,t.useState)({name:(null===e||void 0===e?void 0:e.name)||"",email:(null===e||void 0===e?void 0:e.email)||"",phone:(null===e||void 0===e?void 0:e.phone)||"",dateOfBirth:null!==e&&void 0!==e&&e.dateOfBirth?new Date(e.dateOfBirth).toISOString().split("T")[0]:""}),[u,f]=(0,t.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[p,w]=(0,t.useState)(!1),[v,g]=(0,t.useState)(!1),[x,j]=(0,t.useState)(""),[N,P]=(0,t.useState)(""),[b,y]=(0,t.useState)(""),[O,S]=(0,t.useState)(""),[C,B]=(0,t.useState)(!1);(0,t.useEffect)((()=>{e&&"admin"===e.role||s("/dashboard")}),[e,s]),(0,t.useEffect)((()=>{e&&h({name:e.name||"",email:e.email||"",phone:e.phone||"",dateOfBirth:e.dateOfBirth?new Date(e.dateOfBirth).toISOString().split("T")[0]:""})}),[e]);const A=e=>{const{name:a,value:s}=e.target;h((e=>(0,n.A)((0,n.A)({},e),{},{[a]:s})))},F=e=>{const{name:a,value:s}=e.target;f((e=>(0,n.A)((0,n.A)({},e),{},{[a]:s})))};return(0,i.jsxs)("div",{className:"admin-profile",children:[(0,i.jsxs)("div",{className:"d-flex justify-content-between align-items-center mb-4",children:[(0,i.jsx)("h1",{children:"Admin Profile"}),(0,i.jsx)("div",{children:(0,i.jsx)("button",{className:"btn ".concat(C?"btn-secondary":"btn-primary"),onClick:()=>{B(!C),C&&(h({name:(null===e||void 0===e?void 0:e.name)||"",email:(null===e||void 0===e?void 0:e.email)||"",phone:(null===e||void 0===e?void 0:e.phone)||"",dateOfBirth:null!==e&&void 0!==e&&e.dateOfBirth?new Date(e.dateOfBirth).toISOString().split("T")[0]:""}),j(""),P(""))},children:C?"Cancel Edit":"Edit Profile"})})]}),(0,i.jsx)("p",{className:"text-muted",children:"Manage your admin account settings"}),x&&(0,i.jsx)("div",{className:"alert alert-danger",children:x}),N&&(0,i.jsx)("div",{className:"alert alert-success",children:N}),(0,i.jsxs)("div",{className:"card mb-4",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h3",{children:"Profile Information"})}),(0,i.jsxs)("div",{className:"card-body",children:[(0,i.jsxs)("div",{className:"text-center mb-4",children:[(0,i.jsx)("div",{className:"admin-photo",style:{width:"120px",height:"120px",overflow:"hidden",borderRadius:"50%",margin:"0 auto"},children:(0,i.jsx)("img",{src:"/images/person1.jpeg",alt:"Aditya Raj",style:{width:"100%",height:"100%",objectFit:"cover"}})}),(0,i.jsx)("h4",{className:"mt-3",children:"Aditya Raj"}),(0,i.jsx)("p",{className:"text-muted",children:"Administrator"})]}),C?(0,i.jsxs)("form",{onSubmit:async s=>{s.preventDefault();try{w(!0),j(""),P("");const{email:s}=m,o=(0,r.A)(m,c),l={};if(Object.keys(o).forEach((a=>{""!==o[a]&&o[a]!==e[a]&&(l[a]=o[a])})),0===Object.keys(l).length)return P("No changes to save"),void B(!1);console.log("Updating admin profile with data:",l);const i=await d.Er.updateProfile(l);var t;if(i.data&&i.data.success)P("Profile updated successfully!"),a&&a((0,n.A)((0,n.A)({},e),l)),B(!1);else j("Failed to update profile: "+((null===(t=i.data)||void 0===t?void 0:t.error)||"Unknown error"))}catch(o){console.error("Profile update error:",o);let e="Failed to update profile. Please try again later.";if(o.response){const a=o.response.status;o.response.data&&o.response.data.error?e=o.response.data.error:400===a?e="Invalid data. Please check your inputs.":401===a?(e="Not authorized. Please log in again.",o.preventAlert=!0):404===a?e="Profile not found. Please try logging out and back in.":500===a&&(e="Server error. Please try again later.")}j(e)}finally{w(!1)}},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"name",children:"Full Name"}),(0,i.jsx)("input",{type:"text",className:"form-control",id:"name",name:"name",value:m.name,onChange:A,required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"email",children:"Email"}),(0,i.jsx)("input",{type:"email",className:"form-control",id:"email",name:"email",value:m.email,onChange:A,required:!0,disabled:!0}),(0,i.jsx)("small",{className:"form-text text-muted",children:"Email cannot be changed"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"phone",children:"Phone"}),(0,i.jsx)("input",{type:"tel",className:"form-control",id:"phone",name:"phone",value:m.phone,onChange:A})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"dateOfBirth",children:"Date of Birth"}),(0,i.jsx)("input",{type:"date",className:"form-control",id:"dateOfBirth",name:"dateOfBirth",value:m.dateOfBirth,onChange:A})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:p,children:p?"Saving...":"Save Changes"})]}):(0,i.jsxs)("div",{className:"row",children:[(0,i.jsx)("div",{className:"col-md-3 font-weight-bold",children:"Name:"}),(0,i.jsx)("div",{className:"col-md-9",children:null===e||void 0===e?void 0:e.name}),(0,i.jsx)("div",{className:"col-md-3 font-weight-bold mt-3",children:"Email:"}),(0,i.jsx)("div",{className:"col-md-9 mt-3",children:null===e||void 0===e?void 0:e.email}),(0,i.jsx)("div",{className:"col-md-3 font-weight-bold mt-3",children:"Phone:"}),(0,i.jsx)("div",{className:"col-md-9 mt-3",children:(null===e||void 0===e?void 0:e.phone)||"Not specified"}),(0,i.jsx)("div",{className:"col-md-3 font-weight-bold mt-3",children:"Date of Birth:"}),(0,i.jsx)("div",{className:"col-md-9 mt-3",children:null!==e&&void 0!==e&&e.dateOfBirth?new Date(e.dateOfBirth).toLocaleDateString():"Not specified"})]})]})]}),(0,i.jsxs)("div",{className:"card mb-4",children:[(0,i.jsx)("div",{className:"card-header",children:(0,i.jsx)("h3",{children:"Change Password"})}),(0,i.jsxs)("div",{className:"card-body",children:[b&&(0,i.jsx)("div",{className:"alert alert-danger",children:b}),O&&(0,i.jsx)("div",{className:"alert alert-success",children:O}),(0,i.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),u.newPassword===u.confirmPassword)if(u.newPassword.length<8)y("New password must be at least 8 characters long");else try{g(!0),y(""),S(""),console.log("Submitting admin password change request");const e=await d.Er.changePassword({currentPassword:u.currentPassword,newPassword:u.newPassword});e.data&&e.data.success?(console.log("Password changed successfully"),S("Password changed successfully! You will need to log in again with your new password."),f({currentPassword:"",newPassword:"",confirmPassword:""})):(console.error("Failed to change password:",e.data),y(e.data.error||"Failed to change password"))}catch(r){if(console.error("Password change error:",r),r.response){var a,s;const e=r.response.status,n=(null===(a=r.response.data)||void 0===a?void 0:a.error)||(null===(s=r.response.data)||void 0===s?void 0:s.message)||"An unknown error occurred";y(401===e?"Current password is incorrect":400===e?n:404===e?"Password change endpoint not found. Please contact support.":"Error (".concat(e,"): ").concat(n))}else r.request?y("No response from server. Please check your internet connection."):y("Failed to change password. Please try again later.")}finally{g(!1)}else y("New passwords do not match")},children:[(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"currentPassword",children:"Current Password"}),(0,i.jsx)("input",{type:"password",className:"form-control",id:"currentPassword",name:"currentPassword",value:u.currentPassword,onChange:F,required:!0})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"newPassword",children:"New Password"}),(0,i.jsx)("input",{type:"password",className:"form-control",id:"newPassword",name:"newPassword",value:u.newPassword,onChange:F,required:!0}),(0,i.jsx)("small",{className:"form-text text-muted",children:"Password must be at least 8 characters long"})]}),(0,i.jsxs)("div",{className:"form-group",children:[(0,i.jsx)("label",{htmlFor:"confirmPassword",children:"Confirm New Password"}),(0,i.jsx)("input",{type:"password",className:"form-control",id:"confirmPassword",name:"confirmPassword",value:u.confirmPassword,onChange:F,required:!0})]}),(0,i.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:v,children:v?"Updating...":"Change Password"})]})]})]})]})}},986:(e,a,s)=>{function r(e,a){if(null==e)return{};var s,r,n=function(e,a){if(null==e)return{};var s={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==a.indexOf(r))continue;s[r]=e[r]}return s}(e,a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(r=0;r<t.length;r++)s=t[r],-1===a.indexOf(s)&&{}.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}s.d(a,{A:()=>r})}}]);
//# sourceMappingURL=697.8067350b.chunk.js.map